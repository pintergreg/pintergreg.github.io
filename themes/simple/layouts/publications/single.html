{{ partial "header.html" . }}
{{ partial "nav.html" "publications" }}

<div class="container mt-3">
    <h1>{{ .Title }}</h1>
</div>
<div class="container pb-5">
{{ $papers := slice }}
{{ range $.Site.Data.publications }}
  {{ $papers = $papers | append . }}
{{ end }}

{{- $.Scratch.Set "last_year" 3000 }}
    {{- range (sort (where $papers "type" "ne" "preprint") ".year" "desc") -}}
    {{- if lt (int .year) ($.Scratch.Get "last_year") }}
    <div class="border-bottom">
        <div class="text-end mt-2">{{.year}}</div>
    </div>
    {{ $.Scratch.Set "last_year" (int .year) }}
    {{- end }}
    <section class="mt-4">
        <h2 class="fs-5">{{ .title }}</h2>
        <div>{{ delimit (partial "format_names.func" .authors) ", " }}</div>
        {{- if eq .type "journal" }}
        <div>{{.journal}} {{.year}}, {{.volume}}{{with .issue }} ({{.}}){{end}}; <a href="https://doi.org/{{.doi}}">{{.doi}}</a></div>
        {{- end }}

        <div>
            {{ $id := .doi | replaceRE "\\.|/" "-" }}
            <span class="badge bg-dark" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-{{$id}}" aria-expanded="false" aria-controls="collapse-{{$id}}">
                abstract
            </span>
            <div class="collapse" id="collapse-{{$id}}">
                <div class="card card-body">
                {{.abstract}}
                </div>
            </div>
        </div>
         <div class="fs-6">
            {{- range .keywords }}
        <span class="badge bg-secondary">{{.}}</span>
        {{- end}}
        </div>
    </section>
    {{- end -}}
</div>
{{ partial "footer.html" . }}
